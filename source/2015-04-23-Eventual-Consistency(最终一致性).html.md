---
title: Eventual Consistency(最终一致性) - 分布式数据库相关理论 Part 2
date: 2015-04-23
author: Michael Ding
tags:
- 分布式
- 数据库
---

## 1. Eventual Consistency 概述

分布式数据库必须要有 `分区容忍性(Partition Tolerant)`，所以主要是在 `一致性(Consistent)` 和 `可用性(Available)` 之间做选择。
虽然在 CAP 理论中，选择了 `Availability` 就不可能得到真正的 `Consistency`，但是你可以追求 `最终一致性(Evental Consistency)`

`evental Consistency` 背后的思路是：每个系统节点总是 `Available` 的，同时任何的写(修改数据)操作都会在后台同步给系统的其他节点。
这意味着，在任意时刻，整个系统是`Inconsistent(不一致的)`，然而从概率上讲，大多数的请求得到的值是准确的。

互联网的 DNS(域名服务) 就是最终一致性的一个非常好的例子。你注册了一个域名，
这个新域名需要几天的时间才能通知给所有的 DNS 服务器。但是不管什么时候，你能够连接到的任意 DNS 服务器对你来说都是 'Available' 的。

## 2. Eventual Consistency 小故事

让我们接着之前的[小故事](/2015/04/22/理解CAP理论.html).

假设你不是深山里，是被抓到一个孤岛上造方舟。

`2015年7月3日`——距离你被抓来造方舟已经将近3个月，你在孤岛的海边捡到了一个漂流瓶，里面写着：

> 最新一期暴走大事件是第四季第2期

所以你知道：最新一期暴走大事件至少是`第四季第2期`。

假设暴漫的粉丝喜欢玩漂流瓶——只要暴走大事件有更新，就会把最新一期的暴走大事件写在纸上，然后通过漂流瓶扔向大海。
这样，像你这样的被 `Partition` 的人，总是能是不是地收到记录着最新一期暴走大事件是什么的漂流瓶。
换句话说，虽然每一时刻，关于“最新一期暴走大事件是什么”你并不一定知道的是正确的答案，但你总是会 `eventually(最终)` 知道正确答案。
